# CVE2016-4487

[related Document](https://gcc.gnu.org/bugzilla/show_bug.cgi?id=70481)

## Double Free(DF)
DF occurs at `libiberty/cplus-dem.c:4319`

```c
static int
register_Btype (struct work_stuff *work)
{
  int ret;

  if (work -> numb >= work -> bsize)
    {
      if (work -> bsize == 0)
	{
	  work -> bsize = 5;
	  work -> btypevec = XNEWVEC (char *, work->bsize);
	}
      else
	{
	  work -> bsize *= 2;
	  work -> btypevec
	    = XRESIZEVEC (char *, work->btypevec, work->bsize);
	}
    }
  ret = work -> numb++;
  work -> btypevec[ret] = NULL; // This point!
  return(ret);
}
```