# CVE2019-7703

[related Document](https://github.com/WebAssembly/binaryen/issues/1865)

## Use After Free (UAF)
UAF occurs at `wasm/wasm-binary.cpp:1954`
```cpp
void WasmBinaryBuilder::visitCall(Call* curr) {
  if (debug) std::cerr << "zz node: Call" << std::endl;
  auto index = getU32LEB();
  FunctionType* type;
  if (index < functionImports.size()) {
    auto* import = functionImports[index];
    type = wasm.getFunctionType(import->type);
  } else {
    auto adjustedIndex = index - functionImports.size();
    type = functionTypes[adjustedIndex]; // This point!
  }
  assert(type);
  auto num = type->params.size();
  curr->operands.resize(num);
  for (size_t i = 0; i < num; i++) {
    curr->operands[num - i - 1] = popNonVoidExpression();
  }
  curr->type = type->result;
  functionCalls[index].push_back(curr); 
  curr->finalize();
}

```